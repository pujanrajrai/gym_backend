


{% extends 'datatable_base.html' %}
{% load static %}
{% block title %}Expire List{% endblock %}
{% block pagetitle %}Expire List{% endblock %}
{%block addbutton%}
{% endblock %}

{% block table %}
    <div class="box-content">
        <!-- /.dropdown js__dropdown -->
        <div class="table-responsive">
            <table id="example" class="display compact nowrap" style="width:100%">
                <thead>
                    <tr>
                        <th>S.N</th>
                        <th>Name</th>
                        <th>Phone Number</th>
                        <th>Plan Name</th>
                        <th>Starting Date</th>
                        <th>Ending Date</th>
                        <th>Remaining Days</th>
                        <th>Total Cost</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tfoot>
                    <tr>
                        <th>S.N</th>
                        <th>Name</th>
                        <th>Phone Number</th>
                        <th>Plan Name</th>
                        <th>Starting Date</th>
                        <th>Ending Date</th>
                        <th>Remaining Days</th>
                        <th>Total Cost</th>
                        <th>Action</th>
                    </tr>
                </tfoot>
                <tbody>
                    {% comment %} {% for user in users %}
                    <tr>
                        <td></td>
                        <td>{{ user.user_profile.fullname }}</td>
                        <td>{{ user.phone_number }}</td>
                        <td>{{ user.user_profile.userplan.first.userplandetails.first.plan.name }}</td>
                        <td>{{ user.user_profile.userplan.first.starting_date }}</td>
                        <td>{{ user.user_profile.userplan.first.highest_ending_date }}</td>
                        <td>{{ user.user_profile.userplan.first.remaining_days }}</td>
                        <td>{{ user.user_profile.userplan.first.total }}</td>
                        <td><a href="{% url 'accounts:pages:profile_redirect' user.pk %}" class="btn btn-sm btn-dark"><i class="fa fa-trash"></i>&nbsp;View Plan</a>&nbsp;
                            <a href="{% url 'plan:pages:userplan:extend_user_plan' user.pk %}" class="btn btn-sm btn-dark"><i class="fa fa-trash"></i>&nbsp;Extends</a></td>

                    </tr>
                    {% endfor %} {% endcomment %}
                </tbody>
            </table>
            
{% endblock %} 
{% block js %}
<script>
    $(document).ready(function () {
        // Destroy the default DataTable initialized in datatable_base
        var existingTable = $.fn.dataTable.fnIsDataTable('#example') ? $('#example').DataTable() : null;
        if (existingTable) {
            existingTable.destroy();
        }

        $('#example').DataTable({
            responsive: true,
            serverSide: true,
            processing: true,
            ajax: {
                url: "{% url 'accounts:pages:expire_plan_list_data' %}",
            },
            columns: [
                { data: 'sn', orderable: false, searchable: false },
                { data: 'name' },
                { data: 'phone_number' },
                { data: 'plan_name' },
                { data: 'starting_date' },
                { data: 'ending_date' },
                { data: 'remaining_days' },
                { data: 'total_cost' },
                { data: 'actions', orderable: false, searchable: false }
            ],
            pageLength: 20,
            lengthMenu: [
                [10, 20, 50, 100, 200],
                [10, 20, 50, 100, 200]
            ],
            drawCallback: function (settings) {
                var api = this.api();
                var start = api.page.info().start;
                api.column(0, { search: 'applied', order: 'applied' }).nodes().each(function (cell, i) {
                    cell.innerHTML = start + i + 1;
                });
            }
        });
    });
</script>
{% endblock %}

